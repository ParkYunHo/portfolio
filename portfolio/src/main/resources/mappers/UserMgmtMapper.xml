<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.portfolio.yoonho.dao.UserMgmtMapper">

<<<<<<< HEAD
	<sql id="selectCol">
		SELECT USER_ID as userId, USER_NAME as userName, EMAIL_ADDR as userEmail, PHONE_NO as userPhone
	</sql>

	<sql id="tableName_dev">
		FROM EC_SM_USER_MASTER_T
	</sql>
	<sql id="tableName">
=======
	<select id="getUserInfo" parameterType="String" resultType="com.portfolio.yoonho.model.UserInfoVO">
		SELECT USER_ID as userId, USER_NAME as userName, EMAIL_ADDR as userEmail, PHONE_NO as userPhone
>>>>>>> branch 'main' of https://github.com/ParkYunHo/portfolio.git
		FROM EC_SM_USER_MASTER
	</sql>

	<select id="getUserInfo" parameterType="String" resultType="com.portfolio.yoonho.model.UserInfoVO">
		<include refid="selectCol" />
		FROM <include refid="tableName" />
		WHERE 1=1
		AND UPPER(USER_ID) = UPPER(#{userId})
		ORDER BY USER_ID
	</select>
	
	<select id="getUserInfoAll" resultType="HashMap">
		<include refid="selectCol" />
		FROM <include refid="tableName" />
		ORDER BY USER_ID
	</select>
	
	<insert id="registerUserInfo" parameterType="com.portfolio.yoonho.model.UserInfoVO">
		INSERT INTO <include refid="tableName" />
		SELECT 	#{userId},
				#{userName},
				2,
				#{userPhone},
				#{userEmail},
				ENCRYPT(#{userPw}), 
				null,
				'1',
				null,
				'ADMIN',
				SYSDATE
		FROM DUAL 
	</insert>
	
	<update id="updateUserInfo" parameterType="HashMap">
		UPDATE <include refid="tableName" /> 
		SET 
			USER_PW = ENCRYPT(#{userInfo.userPw}),
			USER_NAME = #{userInfo.userName},
			EMAIL_ADDR = #{userInfo.userEmail},
			PHONE_NO = #{userInfo.userPhone}
		WHERE UPPER(USER_ID) = UPPER(#{userId})
	</update>
	
	<delete id="deleteUserInfo" parameterType="String">
		DELETE FROM <include refid="tableName" />
		WHERE UPPER(USER_ID) = UPPER(#{userId})
	</delete>
</mapper>